<!DOCTYPE html>
<html lang="ch" xmlns:th="http://www.thymeleaf.org/">
<head>
    <meta charset="UTF-8">
    <title th:text="#{list.title}">新冠肺炎疫情实时更新</title>
    <link rel="stylesheet" href="epidemic.html" >
    <link rel="stylesheet" href="css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <script src="js/jquery-3.5.1.min.js" type="text/javascript"></script>
    <script src="js/jquery-3.5.1.js" type="text/javascript"></script>
    <script src="js/bootstrap.js" type="text/javascript"></script>
    <script src="js/bootstrap.bundel.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="echarts/echarts.min.js"></script>
    <script type="text/javascript" src="echarts/china.js"></script>
    <style type="text/css">
        .body{
            margin: 0 22%;
            box-shadow: 0 0 1.333vw rgba(0,0,0,.1);
        }
        .content{
            margin: 20px 50px;
        }
        .text-blod{
            font-weight: bold;
        }

    </style>
</head>
<body class="body">
    <div class="content h1 text-blod" style="text-align: center">新型冠状病毒肺炎<br>疫情实时更新</div>
<!--疫情地图-->
    <div class="content china-map"><!-- 为ECharts准备一个具备大小（宽高）的Dom -->
        <div id="chinaMap" style="width: 100%;height:667px;"></div>
        <!--要接收服务端的数据 并且使用thymeleaf-->
        <script th:inline="javascript">
            // 基于准备好的dom，初始化echarts实例
            var myChart = echarts.init(document.getElementById('chinaMap'));

            var confirm = [[${confirmMap}]];
            var nowConfirm = [[${nowConfirmMap}]];

            option = {
                title: {
                    text: '国内疫情地图',
                    left: 'center'
                },
                tooltip: {
                    trigger: 'item'
                },
                legend: {
                    orient: 'vertical',
                    left: 'left',
                    data: ['现有确诊','累计确诊']  //
                },
                // 根据数值范围渲染颜色的组件
                visualMap: {
                    type: 'piecewise',
                    click: false,
                    pieces: [
                        {min: 1000, max: 1000000, label: '1000人以上', color: '#f00'},
                        {min: 500, max: 999, label: '500-999人', color: '#ff6341'},
                        {min: 100, max: 499, label: '100-499人', color: '#ffa577'},
                        {min: 10, max: 99, label: '10-99人', color: '#ffcea0'},
                        {min: 1, max: 9, label: '0-9人', color: '#ffeca4'},
                        {min: 0, max: 0, label: '0人', color: '#e2ebf4'}
                    ],
                    calculable: true
                },
                // 右侧显示  数据  保存图片等功能的小工具
                // toolbox: {
                //     show: true,
                //     orient: 'vertical',
                //     left: 'right',
                //     top: 'center',
                //     feature: {
                //         mark: {show: true},
                //         dataView: {show: true, readOnly: false},
                //         restore: {show: true},
                //         saveAsImage: {show: true}
                //     }
                // },
                series: [
                    {
                        name: '现有确诊',
                        type: 'map',
                        mapType: 'china',
                        roam: false,
                        label: {
                            normal: {
                                show: true,
                                position: 'center',
                                textStyle: {
                                    color: 'rgba(0,0,0,0.4)'
                                }
                            },
                            emphasis: {
                                show: true
                            }
                        },
                        data: JSON.parse(nowConfirm)
                    },
                    {
                        name: '累计确诊',
                        type: 'map',
                        mapType: 'china',
                        roam: false,
                        label: {
                            normal: {
                                show: true,
                                position: 'center',
                                textStyle: {
                                    color: 'rgba(0,0,0,0.4)'
                                }
                            },
                            emphasis: {
                                show: true
                            }
                        },
                        data: JSON.parse(confirm)
                    }
                ]
            }

            // 使用刚指定的配置项和数据显示图表。
            myChart.setOption(option);

        </script>
    </div>
<!--条形图-->
    <div class="content china-graphBar">
        <!-- 为 ECharts 准备一个具备大小（宽高）的 DOM -->
        <div id="graphBar" style="width: 100%;height:400px;"></div>
        <script th:inline="javascript">

            $(function () {
                $.ajax({
                    url:'graphBar',
                    type:'post',
                    async:true,
                    success:function (result) {
                        // 基于准备好的dom，初始化echarts实例
                        var myChart = echarts.init(document.getElementById('graphBar'));
                        var nameList = result.nameList;
                        var confirmList = result.confirmList;
                        // 指定图表的配置项和数据
                        var option = {
                            title: {
                                text: '境外输入省市TOP10'
                            },
                            tooltip: {
                                trigger: 'axis'
                            },
                            xAxis: {
                                data: nameList
                            },
                            yAxis: {
                                type: 'value'
                            },
                            series: [{
                                name:'境外输入',
                                type: 'bar',
                                data: confirmList,
                                barWidth: '60%',
                                color: '#ff8619'
                            }]
                        };
                        // 使用刚指定的配置项和数据显示图表。
                        myChart.setOption(option);
                    },
                    dataType:'json'
                })
            });
        </script>
    </div>
<!--折现图-->
    <div class="content china-graph">
        <!-- 为 ECharts 准备一个具备大小（宽高）的 DOM -->
        <div id="graph" style="width: 100%;height:400px;"></div>
        <script th:inline="javascript">
            $(function () {

                $.ajax({
                    url:'graph',
                    type:'post',
                    async: true,
                    success:function (result) {
                        // 基于准备好的dom，初始化echarts实例
                        var myChart = echarts.init(document.getElementById('graph'));

                        var dateList = result.dateList;
                        var confirm = result.confirmList;
                        var heal = result.healList;
                        var dead = result.deadList;

                        // 指定图表的配置项和数据
                        var option = {
                            title: {
                                text: '全国累计确诊/治愈/死亡趋势'
                            },
                            tooltip: {
                                trigger: 'axis'
                            },
                            legend: {
                                data:['确诊','治愈','死亡']
                            },
                            xAxis: {
                                data: dateList
                            },
                            yAxis: {
                                type: 'value'
                            },
                            series: [{
                                name: '确诊',
                                type: 'line',
                                data: confirm
                            },{
                                name: '治愈',
                                type: 'line',
                                data: heal
                            },{
                                name: '死亡',
                                type: 'line',
                                data: dead
                            }]
                        };
                        // 使用刚指定的配置项和数据显示图表。
                        myChart.setOption(option);
                    },
                    dataType: 'json'
                })
            });
        </script>
    </div>
<!--表-->
    <div class="content china-table">
        <div class="text-blod"><h2 th:text="#{list.h2}">中国疫情(包含港澳台)</h2></div>

        <table class="table">
            <thead class="thead-dark">
            <tr>
                <th scope="col" style="" class="border-0 bg-light text-dark" th:text="#{list.table.name1}">地区</th>
                <th scope="col" style="background-color: #fffae9" class="border-0 text-warning" th:text="#{list.table.name2}">现有确诊</th>
                <th scope="col" style="background-color: #fff0f1" class="border-0 text-danger" th:text="#{list.table.name3}">累计确诊</th>
                <th scope="col" style="background-color: #e9ffee" class="border-0 text-success" th:text="#{list.table.name4}">治愈</th>
                <th scope="col" style="" class="border-0 bg-light text-dark" th:text="#{list.table.name5}">死亡</th>
            </tr>
            </thead>
            <tbody >
            <tr th:each="data:${areaTree}">
                <td class="text-blod border-top-0 border-bottom" style="font-size: 24px;height: 3em" th:text="${data.name}">0</td>
                <td class="text-blod border-top-0 border-bottom" style="font-size: 20px;height: 3em" th:text="${data.nowConfirm}">0</td>
                <td class="text-blod border-top-0 border-bottom" style="font-size: 20px;height: 3em" th:text="${data.confirm}">0</td>
                <td class="text-blod border-top-0 border-bottom" style="font-size: 20px;height: 3em" th:text="${data.heal}">0</td>
                <td class="text-blod border-top-0 border-bottom" style="font-size: 20px;height: 3em" th:text="${data.dead}">0</td>
            </tr>
            </tbody>
        </table>
    </div>
<!--数据来源阐释-->
    <div class="content text-secondary">数据来源：腾讯新闻、丁香医生</div>
</body>
</html>